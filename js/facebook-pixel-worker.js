var otButtonCheckoutWorker='.bettercart_checkout,[name^="checkout"],[name^="checkout"] .loader-button__text,.shopify-payment-button__button,.btn-checkout,a.fbq-checkout,.checkout_btn,.OTCheckout,.OTCheckout span,#cart .action_button.right, shop-pay-wallet-button, shop-pay-wallet-button button, shop-pay-wallet-button slot';function otDetectPixels(t){console.log("%c Omega Facebook pixels: Event tracking using the Web worker codebase","color: black; background: #EFDCCC;padding: 5px; border-radius: 5px");let e={...OT_DATA_CUSTOMER__TRACK_FB};""!=ot_ip&&(e={...e,client_ip_address:ot_ip}),"FREE"==omegaFBSettings?.settings?.plan_configs?.plan_type&&omegaFBSettings?.settings?.plan_configs?.order_remain<=0||t.forEach(t=>{fbq("init",t,e)})}function otHandleCheckWorkingPage(){return!otDisagreeForTracking()&&"undefined"!=typeof omegaFBSettings&&void 0!==omegaFBSettings.settings.is_enable_web_pixel&&"0"!=omegaFBSettings.settings.is_enable_web_pixel&&"1"==omegaFBSettings.settings.enable}localStorage.removeItem("ot_tracking_ic_shop_pay"),otHandleCheckWorkingPage()&&otMultiFacebookPixelWorker({},omegaFBSettings.settings);var debounceTimeout=null;async function otTrackViewContentWorker(a){var n="1"==omegaFBSettings?.settings?.content_type_event?"product":"product_group";if("undefined"!=typeof arrayFBPixelTrack&&0<arrayFBPixelTrack.length&&-1<fb_pageURL.indexOf("/products/")){r=-1<fb_pageURL.indexOf("?")?(r=fb_pageURL.split("?"))[0]+".json":fb_pageURL+".json";var r=await otGetInfoProductByLink(r);-1<r.title.indexOf("'")&&(r.title=r.title.replace(/'/g,""));let e=ot_getUrlParam("variant"),t=e?""+e:""+meta.product.variants[0].id,o=("product_group"==n&&(t=void 0!==r.id?""+r.id:""+meta.product.id),r.variants[0].price);null!=e&&meta.product.variants.forEach(t=>{t.id==e&&(o=parseInt(t.price)/100)}),otCheckEnableTracking("pixel_track_viewcontent")&&fbq("track","ViewContent",{content_ids:[t],content_type:n,value:o,content_name:r.title,currency:Shopify.currency.active},{eventID:a}),!otCheckEnableTracking("capi_track_viewcontent")||"FREE"==omegaFBSettings?.settings?.plan_configs?.plan_type&&omegaFBSettings?.settings?.plan_configs?.order_remain<=0||trackEventFBConversionAPI({},{action:"ViewContent",event_id:a,event_source_url:fb_pageURL,content_ids:[t],content_type:n,value:o,content_name:r.title,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}}setTimeout(()=>{new MutationObserver(function(t){t.forEach(function(t){debounceTimeout&&clearTimeout(debounceTimeout),debounceTimeout=setTimeout(()=>{var t;null!=localStorage.getItem("OT_DATA_TRIGGER_ATC_NEW_TRIGGER")?otHandleCheckWorkingPage()?(t=JSON.parse(localStorage.getItem("OT_DATA_TRIGGER_ATC_NEW_TRIGGER")),omegaCallBackAddToCartTrigger(t)):localStorage.removeItem("OT_DATA_TRIGGER_ATC_NEW_TRIGGER"):otHandleCheckWorkingPage()&&checkAddToCartEvent(),debounceTimeout=null},1e3)})}).observe(document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})},2e3);const LIST_SHOP_FIRE_VIEW_CONTENT_VARIANT_CHANGES=["thuyet-tester-2.myshopify.com","long-testapp.myshopify.com","twoowls-store.myshopify.com"];if(LIST_SHOP_FIRE_VIEW_CONTENT_VARIANT_CHANGES.includes(Shopify.shop)){let e=ot_getUrlParam("variant");const q=new MutationObserver(()=>{requestAnimationFrame(()=>{var t=ot_getUrlParam("variant");t&&t!==e&&(e=t,otTrackViewContentWorker(generateEventID(36)))})});q.observe(document.body,{childList:!0,subtree:!0})}function checkAddToCartEvent(){var i={};getItemOnCartPageFB(function(t){var e=localStorage.getItem("item_count");localStorage.setItem("OTPXADDED",1),e!=t.item_count&&window.localStorage.setItem("item_count",t.item_count);let r="1"==omegaFBSettings.settings.content_type_event?"product":"product_group";if(0<t.items.length&&"shipping-protection"!=t.items[0].handle&&e<t.item_count){let o=t.items[0],a=(localStorage.setItem("OTPXADDED",0),localStorage.setItem("item_count",t.item_count),""+o.variant_id),n=("product_group"==r&&(a=""+o.product_id),generateEventID(36));otCheckEnableTracking("pixel_track_addtocart")&&arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"AddToCart",{content_ids:a,content_type:r,value:parseInt(o.price)/100,content_name:o.product_title,currency:Shopify.currency.active},n)}),otCheckEnableTracking("capi_track_addtocart")&&(e=detectLastInfoATCByProductId(o.product_id,t.items),trackEventFBConversionAPI(i,{action:"AddToCart",event_id:n,event_source_url:fb_pageURL,content_ids:a,content_type:r,value:parseInt(o.price)/100,content_name:o.product_title,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,products:e,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign}))}})}async function otMultiFacebookPixelWorker(t,e){let a="1"==e.content_type_event?"product":"product_group";if("undefined"!=typeof arrayFBPixelTrack&&0<arrayFBPixelTrack.length){if(otDetectPixels(arrayFBPixelTrack),-1==fb_pageURL.indexOf("/products/")&&"1"!=e.is_enable_trigger&&(n=generateEventID(36),otCheckEnableTracking("pixel_track_pageview")&&fbq("track","PageView",{},{eventID:n}),!otCheckEnableTracking("capi_track_pageview")||"FREE"==omegaFBSettings?.settings?.plan_configs?.plan_type&&omegaFBSettings?.settings?.plan_configs?.order_remain<=0||trackEventFBConversionAPI(t,{action:"PageView",event_id:n,event_source_url:fb_pageURL,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})),-1<fb_pageURL.indexOf("/products/")){r=-1<fb_pageURL.indexOf("?")?(r=fb_pageURL.split("?"))[0]+".json":fb_pageURL+".json";var n=await otGetInfoProductByLink(r),r=(-1<n.title.indexOf("'")&&(n.title=n.title.replace(/'/g,"")),generateEventID(36));let e=ot_getUrlParam("variant");e??meta.product.variants[0].id;"product_group"==a&&(void 0!==n.id?n:meta.product).id;n.variants[0].price;let o;null!=e&&meta.product.variants.forEach(t=>{t.id==e&&(o=parseInt(t.price)/100)}),otCheckEnableTracking("pixel_track_pageview")&&fbq("track","PageView",{},{eventID:r}),otTrackViewContentWorker(r)}-1<fb_pageURL.indexOf("/search")&&(n=generateEventID(36),otCheckEnableTracking("pixel_track_search")&&fbq("track","Search",{search_string:ot_getUrlParam("q")||""},{eventID:n}),otCheckEnableTracking("capi_track_search"))&&trackEventFBConversionAPI(t,{action:"Search",event_id:n,search_string:ot_getUrlParam("q")||"",event_source_url:fb_pageURL,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign}),"1"!=e.is_enable_trigger&&document.addEventListener("click",function(t){(otEventClickIsMatchesDom(t,(2!=e.is_enable_web_pixel||!window?.ShopifyPay)&&2==e.is_enable_web_pixel?"ot_pixel_detect-sample":otButtonCheckoutWorker,otListAllCustomCheckout)||t.target.matches("shopify-google-pay-button, shopify-paypal-button, shopify-apple-pay-button"))&&otTrackICWorker(arrayFBPixelTrack,e,a)})}}function otTrackICWorker(t,e,n){var r={},i=JSON.parse(localStorage.getItem("ot_cart"));if(0<i?.items?.length){let e=[],o=[],a=[];i.items.forEach(function(t){e.push("product_group"==n?""+t.product_id:""+t.variant_id),o.push(t.product_title),a.push({id:t.product_id,title:t.product_title})});var c=generateEventID(36);otCheckEnableTracking("pixel_track_checkout")&&fbq("track","InitiateCheckout",{content_type:n,content_ids:e,currency:Shopify.currency.active,value:parseFloat(i.total_price)/100,num_items:i.item_count,content_name:o},{eventID:c}),otCheckEnableTracking("capi_track_checkout")&&trackEventFBConversionAPIByBeacon(r,{action:"InitiateCheckout",event_id:c,event_source_url:fb_pageURL,content_ids:e,content_type:n,num_items:i.item_count,value:parseFloat(i.total_price)/100,content_name:o,currency:Shopify.currency.active,pixels:t,shop:Shopify.shop,products:a,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}else if(void 0!==meta.product){let e=generateEventID(36);otCheckEnableTracking("pixel_track_checkout")&&t.forEach(function(t){otfbq(""+t,"InitiateCheckout",{content_type:n,content_ids:"product_group"==n?""+meta.product.id:""+meta.product.variants[0].id,currency:Shopify.currency.active,value:meta.product.variants[0].price,num_items:1,content_name:meta.product.variants[0].name},e)}),otCheckEnableTracking("capi_track_checkout")&&trackEventFBConversionAPIByBeacon(r,{action:"InitiateCheckout",event_id:e,event_source_url:fb_pageURL,content_ids:"product_group"==n?""+meta.product.id:""+meta.product.variants[0].id,content_type:n,num_items:1,value:meta.product.variants[0].price,content_name:meta.product.variants[0].name,currency:Shopify.currency.active,pixels:t,shop:Shopify.shop,products:[{id:meta.product.id,title:meta.product.variants[0].name}],obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}window?.ShopifyPay&&localStorage.setItem("ot_tracking_ic_shop_pay","true")}